(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{7285:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AmpStateContext=void 0;var a=((r=n(7294))&&r.__esModule?r:{default:r}).default.createContext({});t.AmpStateContext=a},9546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInAmpMode=i,t.useAmp=function(){return i(a.default.useContext(s.AmpStateContext))};var r,a=(r=n(7294))&&r.__esModule?r:{default:r},s=n(7285);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ampFirst,n=void 0!==t&&t,r=e.hybrid,a=void 0!==r&&r,s=e.hasQuery,i=void 0!==s&&s;return n||a&&i}},6505:function(e,t,n){"use strict";var r=n(930);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHead=d,t.default=void 0;var s,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(7294)),o=(s=n(8252))&&s.__esModule?s:{default:s},l=n(7285),c=n(523),u=n(9546);n(7206);function d(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[i.default.createElement("meta",{charSet:"utf-8"})];return e||t.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),t}function f(e,t){return"string"===typeof t||"number"===typeof t?e:t.type===i.default.Fragment?e.concat(i.default.Children.toArray(t.props.children).reduce((function(e,t){return"string"===typeof t||"number"===typeof t?e:e.concat(t)}),[])):e.concat(t)}var m=["name","httpEquiv","charSet","itemProp"];function p(e,t){return e.reduce((function(e,t){var n=i.default.Children.toArray(t.props.children);return e.concat(n)}),[]).reduce(f,[]).reverse().concat(d(t.inAmpMode)).filter(function(){var e=new Set,t=new Set,n=new Set,r={};return function(a){var s=!0,i=!1;if(a.key&&"number"!==typeof a.key&&a.key.indexOf("$")>0){i=!0;var o=a.key.slice(a.key.indexOf("$")+1);e.has(o)?s=!1:e.add(o)}switch(a.type){case"title":case"base":t.has(a.type)?s=!1:t.add(a.type);break;case"meta":for(var l=0,c=m.length;l<c;l++){var u=m[l];if(a.props.hasOwnProperty(u))if("charSet"===u)n.has(u)?s=!1:n.add(u);else{var d=a.props[u],f=r[u]||new Set;"name"===u&&i||!f.has(d)?(f.add(d),r[u]=f):s=!1}}}return s}}()).reverse().map((function(e,n){var s=e.key||n;if(!t.inAmpMode&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some((function(t){return e.props.href.startsWith(t)}))){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.props||{});return o["data-href"]=o.href,o.href=void 0,o["data-optimized-fonts"]=!0,i.default.cloneElement(e,o)}return i.default.cloneElement(e,{key:s})}))}var h=function(e){var t=e.children,n=i.useContext(l.AmpStateContext),r=i.useContext(c.HeadManagerContext);return i.default.createElement(o.default,{reduceComponentsToState:p,headManager:r,inAmpMode:u.isInAmpMode(n)},t)};t.default=h},8252:function(e,t,n){"use strict";var r=n(7980),a=n(3227),s=n(8361),i=(n(2191),n(5971)),o=n(2715),l=n(1193);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(7294));var d=function(e){i(n,e);var t=c(n);function n(e){var s;return a(this,n),(s=t.call(this,e)).emitChange=function(){s._hasHeadManager&&s.props.headManager.updateHead(s.props.reduceComponentsToState(r(s.props.headManager.mountedInstances),s.props))},s._hasHeadManager=s.props.headManager&&s.props.headManager.mountedInstances,s}return s(n,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),n}(u.Component);t.default=d},9534:function(e,t,n){"use strict";n.r(t);var r=n(29),a=n(9499),s=n(6835),i=n(5988),o=n.n(i),l=n(7794),c=n.n(l),u=n(2593),d=n(1744),f=n(9008),m=n(7294),p=n(4474),h=n(1101),x=n(2563),j=n(6594),v=n(5533),y=n(5893);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O="Earn - ".concat(p.iC),P=function(e){var t=e.address,n=(0,j.v9)((function(e){return e.pools[t]})),r=(0,p.mA)(),a=(0,y.jsxs)(f.default,{children:[(0,y.jsx)("title",{children:O}),(0,y.jsx)("link",{rel:"icon",href:"".concat(p.O4,"/favicon.svg")})]});return n?(0,y.jsxs)(h.T3,{children:[a,(0,y.jsx)(h.VB,{href:"/manage"}),(0,y.jsx)("h1",{children:n.name}),n?n.managerAddress===r?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(k,{pool:n,poolAddress:t,account:r}),(0,y.jsx)(_,{pool:n,poolAddress:t,account:r}),(0,y.jsx)(h.Ng,{pool:n,poolAddress:t})]}):(0,y.jsx)("h3",{children:"Login with manager wallet"}):(0,y.jsx)("h3",{children:"Loading\u2026"})]}):(0,y.jsx)(h.SX,{children:a})};P.getInitialProps=function(e){return{address:(0,p.Kn)(e.query.address)}},t.default=P;var w=["Stake","Unstake"];function k(e){var t=e.pool,n=t.managerAddress,r=t.liquidityTokenAddress,a=t.liquidityTokenDecimals,i=e.poolAddress,o=e.account,l=(0,m.useState)("Stake"),c=l[0],f=l[1],p=(0,x.tJ)(i),j=(0,s.Z)(p,1)[0],v=(0,x.DQ)(i),g=(0,s.Z)(v,2),b=g[0],O=g[1],P=(0,m.useMemo)((function(){if("Stake"!==c)return b?u.O$.from(b.unstakable):void 0}),[c,b]),k=n!==o,_=(0,h.nP)({type:c,onSumbit:"Stake"===c?function(e,t){return e.stake((0,d.parseUnits)(t,a))}:function(e,t){return e.unstake((0,d.parseUnits)(t,a))},refetch:function(){return Promise.all([O(),(0,x.IO)(i)])},poolAddress:i,liquidityTokenAddress:r,liquidityTokenDecimals:a,disabled:Boolean(k),max:P}),N=_.form,S=_.value;return(0,y.jsxs)(h.xu,{loading:Boolean(!("Unstake"!==c||!o)&&!b),overlay:k?"Only manager can stake":void 0,children:[(0,y.jsx)(h.mQ,{tabs:w,currentTab:c,setCurrentTab:f}),N,"Stake"===c?(0,y.jsx)(h.bZ,{style:"warning-filled",title:"You should not stake unless you are prepared to sustain a total loss of the money you have invested plus any commission or other transaction charges"}):(0,y.jsx)(h.$c,{value:S,verb:"unstaking",feePercent:j?j.exitFeePercent:0})]})}function _(e){var t=e.pool,n=t.loanDeskAddress,a=t.liquidityTokenDecimals,i=t.block,l=e.poolAddress,u=e.account,f=(0,j.I0)(),g=(0,p.yL)(),O=(0,m.useState)(null),P=O[0],w=O[1];(0,m.useEffect)((function(){var e=!1,t=x.Ed.attach(n).connect(g);return t.queryFilter(t.filters.LoanRequested(),i).then((function(n){if(e)return[];var r=(0,x.qm)(n.length,t).contract;return Promise.all(n.map((function(e){var t=e.data;return r.loanApplications(t)})))})).then((function(n){return e?[]:Promise.allSettled(n.filter((function(e){return e.status===x.WR.APPLIED||e.status===x.WR.OFFER_MADE})).map((function(e){return Promise.all([(0,p.rY)(e.profileId).then((function(t){return t||fetch("".concat(p.g9,"/profile/").concat(e.profileId)).then((function(e){return e.json()})).then((function(t){return(0,p.wQ)(e.profileId,t),t}))})),e.status===x.WR.OFFER_MADE?t.loanOffers(e.id).then((function(e){return{graceDefaultPeriod:e.gracePeriod.toNumber(),installmentAmount:e.installmentAmount,installments:e.installments,interest:e.apr,amount:e.amount,duration:e.duration}})):void 0]).then((function(t){var n=(0,s.Z)(t,2),r=n[0],a=n[1];return b(b(b(b({},r),e),a),{},{id:e.id.toHexString()})}))})))})).then((function(t){e||w(t.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})))})).catch((function(e){console.error(e)})),function(){e=!0,w(null)}}),[i,n,g]);var k=(0,m.useState)(null),_=k[0],S=k[1];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(h.xu,{children:[(0,y.jsx)("h2",{className:o().dynamic([["2511434330",[p.wP]]]),children:"Loans awaiting approval"}),(0,y.jsx)("div",{className:o().dynamic([["2511434330",[p.wP]]])+" "+((null===P?void 0:"grid")||""),children:P?N(P.filter((function(e){return e.status===x.WR.APPLIED})),S,a):(0,y.jsx)("div",{className:o().dynamic([["2511434330",[p.wP]]])+" loading",children:(0,y.jsx)(v.iT,{speed:.7,stroke:p.wP,width:32,height:32})})})]}),(0,y.jsxs)(h.xu,{children:[(0,y.jsx)("h2",{className:o().dynamic([["2511434330",[p.wP]]]),children:"Active offers"}),(0,y.jsx)("div",{className:o().dynamic([["2511434330",[p.wP]]])+" "+((null===P?void 0:"grid")||""),children:P?N(P.filter((function(e){return e.status===x.WR.OFFER_MADE})),S,a):(0,y.jsx)("div",{className:o().dynamic([["2511434330",[p.wP]]])+" loading",children:(0,y.jsx)(v.iT,{speed:.7,stroke:p.wP,width:32,height:32})})})]}),_?(0,y.jsx)(A,{loan:_,liquidityTokenDecimals:a,onClose:function(){return S(null)},onOffer:function(e,t,r,s,i,o){var l=x.Ed.attach(n).connect(g.getSigner());return(_.status===x.WR.OFFER_MADE?l.updateOffer(_.id,e,t,o,r,s,i).then((function(e){return{tx:e,name:"Update offer"}})):l.offerLoan(_.id,e,t,o,r,s,i).then((function(t){return{tx:t,name:"Offer a loan for ".concat((0,d.formatUnits)(e,a)," ").concat(p.ob)}}))).then((function(e){var t=e.tx,n=e.name;return(0,x.y5)(f,{name:n,tx:t})})).then((function(){S(null),w(P.map((function(n){return n===_?b(b({},n),{},{status:x.WR.OFFER_MADE,amount:e,duration:t,graceDefaultPeriod:o,installmentAmount:r,installments:s,interest:i}):n})))})).catch((function(e){throw console.error(e),e}))},onReject:function(){var e=x.Ed.attach(n).connect(g.getSigner());return(_.status===x.WR.OFFER_MADE?e.cancelLoan(_.id).then((function(e){return{tx:e,name:"Cancel loan",newStatus:x.WR.OFFER_CANCELLED}})):e.denyLoan(_.id).then((function(e){return{tx:e,name:"Reject loan",newStatus:x.WR.DENIED}}))).then((function(e){var t=e.tx,n=e.name,r=e.newStatus;return(0,x.y5)(f,{name:n,tx:t}).then((function(){return r}))})).then((function(e){S(null),w(P.map((function(t){return t===_?b(b({},t),{},{status:e}):t})))})).catch((function(e){throw console.error(e),e}))},onFetchBorrowerInfo:(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.Mj)(u,g.getSigner(),_.profileId,l);case 2:t=e.sent,n=b(b({},_),{},{phone:t.phone,email:t.email}),S(n),w(P.map((function(e){return e===_?n:e})));case 6:case"end":return e.stop()}}),e)})))}):null,(0,y.jsx)(o(),{id:"2511434330",dynamic:[p.wP],children:["h2.__jsx-style-dynamic-selector{font-size:16px;margin-top:0;}",".loading.__jsx-style-dynamic-selector>svg{display:block;margin:10px auto 0;}",".grid.__jsx-style-dynamic-selector{display:grid;grid-template-columns:30% 50% 20%;}",".grid.__jsx-style-dynamic-selector>.name>span{color:".concat(p.wP,";cursor:pointer;}")]})]})}function N(e,t,n){return e.map((function(e){return(0,y.jsxs)(m.Fragment,{children:[(0,y.jsx)("div",{className:"name",children:(0,y.jsx)("span",{onClick:function(){return t(e)},children:e.name})}),(0,y.jsx)("div",{className:"description",children:(0,y.jsxs)("span",{children:[(0,d.formatUnits)(e.amount,n)," ",p.ob," for"," ",(0,h.DL)(e.duration.toNumber())," months"]})}),(0,y.jsx)("div",{className:"address",children:(0,y.jsx)(h.s_,{address:e.borrower})})]},e.id)}))}var S=35..toString();function A(e){var t=e.loan,n=e.onClose,r=e.liquidityTokenDecimals,a=e.onOffer,s=e.onReject,i=e.onFetchBorrowerInfo,l=t.status===x.WR.OFFER_MADE,c=(0,m.useMemo)((function(){var e=(0,d.formatUnits)(t.amount,r),n=t.duration.toNumber(),a=(0,h.DL)(n),s=a.toString();if(l)return{initialAmount:e,initialMonths:s,initialInstallments:t.installments.toString(),initialInstallmentAmount:(0,d.formatUnits)(t.installmentAmount,r),initialInterestValue:(t.interest/10).toString(),initialGraceDefaultPeriod:(t.graceDefaultPeriod/p.u3).toString()};var i=Math.max(Math.ceil(a),1);return{initialAmount:e,initialMonths:s,initialInstallments:i.toString(),initialInstallmentAmount:(0,d.formatUnits)((0,p.Ci)(t.amount,35,i,n),r),initialInterestValue:S,initialGraceDefaultPeriod:"35"}}),[l,r,t]),f=c.initialAmount,j=c.initialMonths,v=c.initialInstallments,g=c.initialInstallmentAmount,b=c.initialInterestValue,O=c.initialGraceDefaultPeriod,P=(0,m.useState)(f),w=P[0],k=P[1],_=(0,m.useState)(j),N=_[0],A=_[1],D=(0,m.useState)(v),E=D[0],M=D[1],C=(0,m.useState)(g),R=C[0],I=C[1],F=(0,m.useState)(b),T=F[0],L=F[1],U=(0,m.useState)(O),W=U[0],q=U[1],Z=(0,m.useState)(!1),B=Z[0],H=Z[1],$=(0,m.useState)(!1),z=$[0],G=$[1],Q=(0,m.useCallback)((function(e){e.preventDefault(),H(!0),a((0,d.parseUnits)(w,r),u.O$.from(Number(N)*p.L$),(0,d.parseUnits)(R,r),parseInt(E,10),10*Number(T),Number(W)*p.u3).catch((function(){H(!1)}))}),[w,N,W,R,E,T,r,a]),V=(0,m.useCallback)((function(){G(!0),s().catch((function(){G(!1)}))}),[s]);return(0,y.jsx)(h.u_,{onClose:n,children:(0,y.jsxs)("form",{onSubmit:Q,className:"jsx-1787981640",children:[(0,y.jsx)("h3",{className:"jsx-1787981640",children:l?"Update Offer":"Offer a Loan"}),(0,y.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Account"}),(0,y.jsx)("div",{className:"jsx-1787981640",children:(0,y.jsx)(h.s_,{address:t.borrower})})]}),(0,y.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Name"}),(0,y.jsx)("div",{className:"jsx-1787981640",children:t.name})]}),(0,y.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Business Name"}),(0,y.jsx)("div",{className:"jsx-1787981640",children:t.businessName})]}),t.phone?(0,y.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Phone"}),(0,y.jsx)("div",{className:"jsx-1787981640",children:(0,y.jsx)("a",{href:"tel:".concat(t.phone),className:"jsx-1787981640",children:t.phone})})]}):null,t.email?(0,y.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Email"}),(0,y.jsx)("div",{className:"jsx-1787981640",children:(0,y.jsx)("a",{href:"mailto:".concat(t.email),className:"jsx-1787981640",children:t.email})})]}):null,t.email||t.phone?null:(0,y.jsx)(h.zx,{type:"button",stone:!0,onClick:i,style:{marginTop:16},children:"Get contact information"}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Amount"}),(0,y.jsx)(h._Z,{decimals:r,value:w,onChange:k})]}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Duration"}),(0,y.jsx)(h._Z,{decimals:4,value:N,onChange:A,noToken:!0,label:"months",paddingRight:60})]}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Installments"}),(0,y.jsx)(h._Z,{decimals:0,value:E,onChange:M,noToken:!0})]}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Interest p/a"}),(0,y.jsx)(h._Z,{decimals:1,value:T,onChange:L,noToken:!0,label:"%",paddingRight:26})]}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Installment amount"}),(0,y.jsx)(h._Z,{decimals:r,value:R,onChange:I})]}),(0,y.jsxs)("label",{className:"jsx-1787981640",children:[(0,y.jsx)("div",{className:"jsx-1787981640 label",children:"Grace Default Period"}),(0,y.jsx)(h._Z,{decimals:2,value:W,onChange:q,noToken:!0,label:"days",paddingRight:44})]}),(0,y.jsxs)("div",{className:"jsx-1787981640 buttons",children:[(0,y.jsx)(h.zx,{disabled:B||z,loading:B,type:"submit",children:l?"Update Offer":"Offer Loan"}),(0,y.jsx)(h.zx,{disabled:B||z,loading:z,onClick:V,type:"button",stone:!0,children:l?"Cancel Offer":"Reject Application"})]}),(0,y.jsx)(o(),{id:"1787981640",children:["form.jsx-1787981640{padding:20px;}","form.jsx-1787981640>h3.jsx-1787981640{margin-top:0;}","form.jsx-1787981640>.field.jsx-1787981640,form.jsx-1787981640>label.jsx-1787981640{display:block;margin-top:16px;}","form.jsx-1787981640>.field.jsx-1787981640>.label.jsx-1787981640,form.jsx-1787981640>label.jsx-1787981640>.label.jsx-1787981640{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}","form.jsx-1787981640>.buttons.jsx-1787981640{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}","form.jsx-1787981640>.buttons.jsx-1787981640>button{margin:16px 8px 0 0;}"]})]})})}},5243:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage/[address]",function(){return n(9534)}])},9008:function(e,t,n){e.exports=n(6505)}},function(e){e.O(0,[774,888,179],(function(){return t=5243,e(e.s=t);var t}));var t=e.O();_N_E=t}]);