(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{7285:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AmpStateContext=void 0;var a=((r=n(7294))&&r.__esModule?r:{default:r}).default.createContext({});t.AmpStateContext=a},9546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInAmpMode=i,t.useAmp=function(){return i(a.default.useContext(s.AmpStateContext))};var r,a=(r=n(7294))&&r.__esModule?r:{default:r},s=n(7285);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ampFirst,n=void 0!==t&&t,r=e.hybrid,a=void 0!==r&&r,s=e.hasQuery,i=void 0!==s&&s;return n||a&&i}},6505:function(e,t,n){"use strict";var r=n(930);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHead=d,t.default=void 0;var s,i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(7294)),o=(s=n(8252))&&s.__esModule?s:{default:s},l=n(7285),c=n(523),u=n(9546);n(7206);function d(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[i.default.createElement("meta",{charSet:"utf-8"})];return e||t.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),t}function f(e,t){return"string"===typeof t||"number"===typeof t?e:t.type===i.default.Fragment?e.concat(i.default.Children.toArray(t.props.children).reduce((function(e,t){return"string"===typeof t||"number"===typeof t?e:e.concat(t)}),[])):e.concat(t)}var m=["name","httpEquiv","charSet","itemProp"];function p(e,t){return e.reduce((function(e,t){var n=i.default.Children.toArray(t.props.children);return e.concat(n)}),[]).reduce(f,[]).reverse().concat(d(t.inAmpMode)).filter(function(){var e=new Set,t=new Set,n=new Set,r={};return function(a){var s=!0,i=!1;if(a.key&&"number"!==typeof a.key&&a.key.indexOf("$")>0){i=!0;var o=a.key.slice(a.key.indexOf("$")+1);e.has(o)?s=!1:e.add(o)}switch(a.type){case"title":case"base":t.has(a.type)?s=!1:t.add(a.type);break;case"meta":for(var l=0,c=m.length;l<c;l++){var u=m[l];if(a.props.hasOwnProperty(u))if("charSet"===u)n.has(u)?s=!1:n.add(u);else{var d=a.props[u],f=r[u]||new Set;"name"===u&&i||!f.has(d)?(f.add(d),r[u]=f):s=!1}}}return s}}()).reverse().map((function(e,n){var s=e.key||n;if(!t.inAmpMode&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some((function(t){return e.props.href.startsWith(t)}))){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.props||{});return o["data-href"]=o.href,o.href=void 0,o["data-optimized-fonts"]=!0,i.default.cloneElement(e,o)}return i.default.cloneElement(e,{key:s})}))}var h=function(e){var t=e.children,n=i.useContext(l.AmpStateContext),r=i.useContext(c.HeadManagerContext);return i.default.createElement(o.default,{reduceComponentsToState:p,headManager:r,inAmpMode:u.isInAmpMode(n)},t)};t.default=h},8252:function(e,t,n){"use strict";var r=n(7980),a=n(3227),s=n(8361),i=(n(2191),n(5971)),o=n(2715),l=n(1193);function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var a=l(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(7294));var d=function(e){i(n,e);var t=c(n);function n(e){var s;return a(this,n),(s=t.call(this,e)).emitChange=function(){s._hasHeadManager&&s.props.headManager.updateHead(s.props.reduceComponentsToState(r(s.props.headManager.mountedInstances),s.props))},s._hasHeadManager=s.props.headManager&&s.props.headManager.mountedInstances,s}return s(n,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),n}(u.Component);t.default=d},9534:function(e,t,n){"use strict";n.r(t);var r=n(9499),a=n(6835),s=n(5988),i=n.n(s),o=n(2593),l=n(1744),c=n(9008),u=n(7294),d=n(5453),f=n(1101),m=n(2563),p=n(6594),h=n(5533),j=n(5893);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y="Earn - ".concat(d.iC),g=function(e){var t=e.address,n=(0,p.v9)((function(e){return e.pools[t]})),r=(0,d.mA)(),a=(0,j.jsxs)(c.default,{children:[(0,j.jsx)("title",{children:y}),(0,j.jsx)("link",{rel:"icon",href:"".concat(d.O4,"/favicon.svg")})]});return n?(0,j.jsxs)(f.T3,{children:[a,(0,j.jsx)(f.VB,{href:"/manage"}),(0,j.jsx)("h1",{children:n.name}),n?n.managerAddress===r?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(O,{pool:n,poolAddress:t}),(0,j.jsx)(P,{pool:n}),(0,j.jsx)(f.Ng,{pool:n,poolAddress:t})]}):(0,j.jsx)("h3",{children:"Login with manager wallet"}):(0,j.jsx)("h3",{children:"Loading\u2026"})]}):(0,j.jsx)(f.SX,{children:a})};g.getInitialProps=function(e){return{address:(0,d.Kn)(e.query.address)}},t.default=g;var b=["Stake","Unstake"];function O(e){var t=e.pool,n=t.managerAddress,r=t.liquidityTokenAddress,s=t.liquidityTokenDecimals,i=e.poolAddress,c=(0,u.useState)("Stake"),p=c[0],h=c[1],x=(0,d.mA)(),v=(0,m.tJ)(i),y=(0,a.Z)(v,1)[0],g=(0,m.DQ)(i),O=(0,a.Z)(g,2),P=O[0],w=O[1],_=(0,u.useMemo)((function(){if("Stake"!==p)return P?o.O$.from(P.unstakable):void 0}),[p,P]),k=n!==x,N=(0,f.nP)({type:p,onSumbit:"Stake"===p?function(e,t){return e.stake((0,l.parseUnits)(t,s))}:function(e,t){return e.unstake((0,l.parseUnits)(t,s))},refetch:function(){return Promise.all([w(),(0,m.IO)(i)])},poolAddress:i,liquidityTokenAddress:r,liquidityTokenDecimals:s,disabled:Boolean(k),max:_}),A=N.form,S=N.value;return(0,j.jsxs)(f.xu,{loading:Boolean(!("Unstake"!==p||!x)&&!P),overlay:k?"Only manager can stake":void 0,children:[(0,j.jsx)(f.mQ,{tabs:b,currentTab:p,setCurrentTab:h}),A,"Stake"===p?(0,j.jsx)(f.bZ,{style:"warning-filled",title:"You should not stake unless you are prepared to sustain a total loss of the money you have invested plus any commission or other transaction charges"}):(0,j.jsx)(f.$c,{value:S,verb:"unstaking",feePercent:y?y.exitFeePercent:0})]})}function P(e){var t=e.pool,n=t.loanDeskAddress,r=t.liquidityTokenDecimals,s=t.block,o=(0,p.I0)(),c=(0,d.yL)(),x=(0,u.useState)(null),y=x[0],g=x[1];(0,u.useEffect)((function(){var e=!1,t=m.Ed.attach(n).connect(c);return t.queryFilter(t.filters.LoanRequested(),s).then((function(n){if(e)return[];var r=(0,m.qm)(n.length,t).contract;return Promise.all(n.map((function(e){var t=e.data;return r.loanApplications(t)})))})).then((function(n){return e?[]:Promise.allSettled(n.filter((function(e){return e.status===m.WR.APPLIED||e.status===m.WR.OFFER_MADE})).map((function(e){return Promise.all([fetch("".concat(d.g9,"/profile/").concat(e.profileId)).then((function(e){return e.json()})),e.status===m.WR.OFFER_MADE?t.loanOffers(e.id).then((function(e){return{graceDefaultPeriod:e.gracePeriod.toNumber(),installmentAmount:e.installmentAmount,installments:e.installments,interest:e.apr}})):void 0]).then((function(t){var n=(0,a.Z)(t,2),r=n[0];return v(v(v(v({},n[1]),r),e),{},{id:e.id.toHexString()})}))})))})).then((function(t){e||g(t.filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})))})).catch((function(e){console.error(e)})),function(){e=!0,g(null)}}),[s,n,c]);var b=(0,u.useState)(null),O=b[0],P=b[1];return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(f.xu,{children:[(0,j.jsx)("h2",{className:i().dynamic([["2511434330",[d.wP]]]),children:"Loans awaiting approval"}),(0,j.jsx)("div",{className:i().dynamic([["2511434330",[d.wP]]])+" "+((null===y?void 0:"grid")||""),children:y?w(y.filter((function(e){return e.status===m.WR.APPLIED})),P,r):(0,j.jsx)("div",{className:i().dynamic([["2511434330",[d.wP]]])+" loading",children:(0,j.jsx)(h.iT,{speed:.7,stroke:d.wP,width:32,height:32})})})]}),(0,j.jsxs)(f.xu,{children:[(0,j.jsx)("h2",{className:i().dynamic([["2511434330",[d.wP]]]),children:"Active offers"}),(0,j.jsx)("div",{className:i().dynamic([["2511434330",[d.wP]]])+" "+((null===y?void 0:"grid")||""),children:y?w(y.filter((function(e){return e.status===m.WR.OFFER_MADE})),P,r):(0,j.jsx)("div",{className:i().dynamic([["2511434330",[d.wP]]])+" loading",children:(0,j.jsx)(h.iT,{speed:.7,stroke:d.wP,width:32,height:32})})})]}),O?(0,j.jsx)(k,{loan:O,liquidityTokenDecimals:r,onClose:function(){return P(null)},onOffer:function(e,t,a,s,i,u){var f=m.Ed.attach(n).connect(c.getSigner());return(O.status===m.WR.OFFER_MADE?f.updateOffer(O.id,e,t,u,a,s,i).then((function(e){return{tx:e,name:"Update offer"}})):f.offerLoan(O.id,e,t,u,a,s,i).then((function(t){return{tx:t,name:"Offer a loan for ".concat((0,l.formatUnits)(e,r)," ").concat(d.ob)}}))).then((function(e){var t=e.tx,n=e.name;return(0,m.y5)(o,{name:n,tx:t})})).then((function(){P(null),g(y.map((function(n){return n===O?v(v({},n),{},{status:m.WR.OFFER_MADE,amount:e,duration:t,graceDefaultPeriod:u,installmentAmount:a,installments:s,interest:i}):n})))})).catch((function(e){throw console.error(e),e}))},onReject:function(){var e=m.Ed.attach(n).connect(c.getSigner());return(O.status===m.WR.OFFER_MADE?e.cancelLoan(O.id).then((function(e){return{tx:e,name:"Cancel loan",newStatus:m.WR.OFFER_CANCELLED}})):e.denyLoan(O.id).then((function(e){return{tx:e,name:"Reject loan",newStatus:m.WR.DENIED}}))).then((function(e){var t=e.tx,n=e.name,r=e.newStatus;return(0,m.y5)(o,{name:n,tx:t}).then((function(){return r}))})).then((function(e){P(null),g(y.map((function(t){return t===O?v(v({},t),{},{status:e}):t})))})).catch((function(e){throw console.error(e),e}))}}):null,(0,j.jsx)(i(),{id:"2511434330",dynamic:[d.wP],children:["h2.__jsx-style-dynamic-selector{font-size:16px;margin-top:0;}",".loading.__jsx-style-dynamic-selector>svg{display:block;margin:10px auto 0;}",".grid.__jsx-style-dynamic-selector{display:grid;grid-template-columns:30% 50% 20%;}",".grid.__jsx-style-dynamic-selector>.name>span{color:".concat(d.wP,";cursor:pointer;}")]})]})}function w(e,t,n){return e.map((function(e){return(0,j.jsxs)(u.Fragment,{children:[(0,j.jsx)("div",{className:"name",children:(0,j.jsx)("span",{onClick:function(){return t(e)},children:e.name})}),(0,j.jsx)("div",{className:"description",children:(0,j.jsxs)("span",{children:[(0,l.formatUnits)(e.amount,n)," ",d.ob," for"," ",(0,f.DL)(e.duration.toNumber())," months"]})}),(0,j.jsx)("div",{className:"address",children:(0,j.jsx)(f.s_,{address:e.borrower})})]},e.id)}))}var _=35..toString();function k(e){var t=e.loan,n=e.onClose,r=e.liquidityTokenDecimals,a=e.onOffer,s=e.onReject,c=t.status===m.WR.OFFER_MADE,p=(0,u.useMemo)((function(){var e=(0,l.formatUnits)(t.amount,r),n=t.duration.toNumber(),a=(0,f.DL)(n);return c?{initialAmount:e,initialMonths:a.toString(),initialInstallmentAmount:(0,l.formatUnits)(t.installmentAmount,r),initialInterestValue:(t.interest/10).toString(),initialGraceDefaultPeriod:(t.graceDefaultPeriod/d.u3).toString()}:{initialAmount:e,initialMonths:a.toString(),initialInstallmentAmount:(0,l.formatUnits)((0,d.qJ)(t.amount,Math.trunc(Date.now()/1e3)-n,35).mul(100).div(Math.trunc(a)).div(100),r),initialInterestValue:_,initialGraceDefaultPeriod:"35"}}),[c,r,t]),h=p.initialAmount,x=p.initialMonths,v=p.initialInstallmentAmount,y=p.initialInterestValue,g=p.initialGraceDefaultPeriod,b=(0,u.useState)(h),O=b[0],P=b[1],w=(0,u.useState)(x),k=w[0],N=w[1],A=(0,u.useState)(v),S=A[0],D=A[1],E=(0,u.useState)(y),M=E[0],C=E[1],R=(0,u.useState)(g),F=R[0],I=R[1],T=(0,u.useState)(!1),L=T[0],U=T[1],q=(0,u.useState)(!1),W=q[0],Z=q[1],H=(0,u.useCallback)((function(e){e.preventDefault(),U(!0),a((0,l.parseUnits)(O,r),o.O$.from(Number(k)*d.L$),(0,l.parseUnits)(S,r),parseInt(k,10),10*Number(M),Number(F)*d.u3).catch((function(){U(!1)}))}),[O,k,F,S,M,r,a]),B=(0,u.useCallback)((function(){Z(!0),s().catch((function(){Z(!1)}))}),[s]);return(0,j.jsx)(f.u_,{onClose:n,children:(0,j.jsxs)("form",{onSubmit:H,className:"jsx-1787981640",children:[(0,j.jsx)("h3",{className:"jsx-1787981640",children:c?"Update Offer":"Offer a Loan"}),(0,j.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Account"}),(0,j.jsx)("div",{className:"jsx-1787981640",children:(0,j.jsx)(f.s_,{address:t.borrower})})]}),(0,j.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Name"}),(0,j.jsx)("div",{className:"jsx-1787981640",children:t.name})]}),(0,j.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Business Name"}),(0,j.jsx)("div",{className:"jsx-1787981640",children:t.businessName})]}),t.phone?(0,j.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Phone"}),(0,j.jsx)("div",{className:"jsx-1787981640",children:(0,j.jsx)("a",{href:"tel:".concat(t.phone),className:"jsx-1787981640",children:t.phone})})]}):null,t.email?(0,j.jsxs)("div",{className:"jsx-1787981640 field",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Email"}),(0,j.jsx)("div",{className:"jsx-1787981640",children:(0,j.jsx)("a",{href:"mailto:".concat(t.email),className:"jsx-1787981640",children:t.email})})]}):null,(0,j.jsxs)("label",{className:"jsx-1787981640",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Amount"}),(0,j.jsx)(f._Z,{decimals:r,value:O,onChange:P})]}),(0,j.jsxs)("label",{className:"jsx-1787981640",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Duration"}),(0,j.jsx)(f._Z,{decimals:0,value:k,onChange:N,noToken:!0,label:"months",paddingRight:60})]}),(0,j.jsxs)("label",{className:"jsx-1787981640",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Interest p/a"}),(0,j.jsx)(f._Z,{decimals:1,value:M,onChange:C,noToken:!0,label:"%",paddingRight:26})]}),(0,j.jsxs)("label",{className:"jsx-1787981640",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Installment amount"}),(0,j.jsx)(f._Z,{decimals:r,value:S,onChange:D})]}),(0,j.jsxs)("label",{className:"jsx-1787981640",children:[(0,j.jsx)("div",{className:"jsx-1787981640 label",children:"Grace Default Period"}),(0,j.jsx)(f._Z,{decimals:2,value:F,onChange:I,noToken:!0,label:"days",paddingRight:44})]}),(0,j.jsxs)("div",{className:"jsx-1787981640 buttons",children:[(0,j.jsx)(f.zx,{disabled:L||W,loading:L,type:"submit",children:c?"Update Offer":"Offer Loan"}),(0,j.jsx)(f.zx,{disabled:L||W,loading:W,onClick:B,type:"button",stone:!0,children:c?"Cancel Offer":"Reject Application"})]}),(0,j.jsx)(i(),{id:"1787981640",children:["form.jsx-1787981640{padding:20px;}","form.jsx-1787981640>h3.jsx-1787981640{margin-top:0;}","form.jsx-1787981640>.field.jsx-1787981640,form.jsx-1787981640>label.jsx-1787981640{display:block;margin-top:16px;}","form.jsx-1787981640>.field.jsx-1787981640>.label.jsx-1787981640,form.jsx-1787981640>label.jsx-1787981640>.label.jsx-1787981640{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}","form.jsx-1787981640>.buttons.jsx-1787981640{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}","form.jsx-1787981640>.buttons.jsx-1787981640>button{margin:16px 8px 0 0;}"]})]})})}},5243:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage/[address]",function(){return n(9534)}])},9008:function(e,t,n){e.exports=n(6505)}},function(e){e.O(0,[774,888,179],(function(){return t=5243,e(e.s=t);var t}));var t=e.O();_N_E=t}]);