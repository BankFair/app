(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{7285:function(e,n,t){"use strict";var a;Object.defineProperty(n,"__esModule",{value:!0}),n.AmpStateContext=void 0;var s=((a=t(7294))&&a.__esModule?a:{default:a}).default.createContext({});n.AmpStateContext=s},9546:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isInAmpMode=i,n.useAmp=function(){return i(s.default.useContext(r.AmpStateContext))};var a,s=(a=t(7294))&&a.__esModule?a:{default:a},r=t(7285);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ampFirst,t=void 0!==n&&n,a=e.hybrid,s=void 0!==a&&a,r=e.hasQuery,i=void 0!==r&&r;return t||s&&i}},6505:function(e,n,t){"use strict";var a=t(930);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}Object.defineProperty(n,"__esModule",{value:!0}),n.defaultHead=u,n.default=void 0;var r,i=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(n,t,a):n[t]=e[t]}return n.default=e,n}(t(7294)),l=(r=t(8252))&&r.__esModule?r:{default:r},o=t(7285),c=t(523),d=t(9546);t(7206);function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[i.default.createElement("meta",{charSet:"utf-8"})];return e||n.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),n}function m(e,n){return"string"===typeof n||"number"===typeof n?e:n.type===i.default.Fragment?e.concat(i.default.Children.toArray(n.props.children).reduce((function(e,n){return"string"===typeof n||"number"===typeof n?e:e.concat(n)}),[])):e.concat(n)}var f=["name","httpEquiv","charSet","itemProp"];function p(e,n){return e.reduce((function(e,n){var t=i.default.Children.toArray(n.props.children);return e.concat(t)}),[]).reduce(m,[]).reverse().concat(u(n.inAmpMode)).filter(function(){var e=new Set,n=new Set,t=new Set,a={};return function(s){var r=!0,i=!1;if(s.key&&"number"!==typeof s.key&&s.key.indexOf("$")>0){i=!0;var l=s.key.slice(s.key.indexOf("$")+1);e.has(l)?r=!1:e.add(l)}switch(s.type){case"title":case"base":n.has(s.type)?r=!1:n.add(s.type);break;case"meta":for(var o=0,c=f.length;o<c;o++){var d=f[o];if(s.props.hasOwnProperty(d))if("charSet"===d)t.has(d)?r=!1:t.add(d);else{var u=s.props[d],m=a[d]||new Set;"name"===d&&i||!m.has(u)?(m.add(u),a[d]=m):r=!1}}}return r}}()).reverse().map((function(e,t){var r=e.key||t;if(!n.inAmpMode&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some((function(n){return e.props.href.startsWith(n)}))){var l=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},e.props||{});return l["data-href"]=l.href,l.href=void 0,l["data-optimized-fonts"]=!0,i.default.cloneElement(e,l)}return i.default.cloneElement(e,{key:r})}))}var x=function(e){var n=e.children,t=i.useContext(o.AmpStateContext),a=i.useContext(c.HeadManagerContext);return i.default.createElement(l.default,{reduceComponentsToState:p,headManager:a,inAmpMode:d.isInAmpMode(t)},n)};n.default=x},8252:function(e,n,t){"use strict";var a=t(7980),s=t(3227),r=t(8361),i=(t(2191),t(5971)),l=t(2715),o=t(1193);function c(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=o(e);if(n){var s=o(this).constructor;t=Reflect.construct(a,arguments,s)}else t=a.apply(this,arguments);return l(this,t)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var d=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,t):{};a.get||a.set?Object.defineProperty(n,t,a):n[t]=e[t]}return n.default=e,n}(t(7294));var u=function(e){i(t,e);var n=c(t);function t(e){var r;return s(this,t),(r=n.call(this,e)).emitChange=function(){r._hasHeadManager&&r.props.headManager.updateHead(r.props.reduceComponentsToState(a(r.props.headManager.mountedInstances),r.props))},r._hasHeadManager=r.props.headManager&&r.props.headManager.mountedInstances,r}return r(t,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),t}(d.Component);n.default=u},2020:function(e,n,t){"use strict";t.r(n);var a=t(9499),s=t(6835),r=t(29),i=t(5988),l=t.n(i),o=t(7794),c=t.n(o),d=t(1744),u=t(2593),m=t(9490),f=t(9008),p=t(7294),x=t(8912),h=t(1101),j=t(2563),y=t(6594),v=t(5893);function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function N(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return S(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw r}}}}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var O="Borrow - ".concat(x.iC),w=function(e){var n,t=e.address,a=(0,x.mA)(),s=(0,y.v9)((function(e){return e.pools[t]})),r=null===(n=x.D.find((function(e){return e.address===t})))||void 0===n?void 0:n.name,i=(0,v.jsxs)(f.default,{children:[(0,v.jsx)("title",{children:O}),(0,v.jsx)("link",{rel:"icon",href:"".concat(x.O4,"/favicon.svg")})]});return s?(0,v.jsxs)(h.T3,{children:[i,(0,v.jsx)(h.VB,{href:"/borrow"}),(0,v.jsx)("h1",{children:r}),(0,v.jsx)(A,{pool:s,poolAddress:t,account:a}),(0,v.jsx)(_,{pool:s,poolAddress:t,account:a}),(0,v.jsx)(B,{pool:s,poolAddress:t,account:a})]}):(0,v.jsx)(h.SX,{children:i})};function _(e){var n=e.pool,t=n.loanDeskAddress,a=n.liquidityTokenDecimals,i=n.block,o=e.poolAddress,m=e.account,f=(0,x.yL)(),b=(0,y.I0)(),g=(0,p.useState)(null),S=g[0],O=g[1],w=(0,p.useRef)();(0,p.useEffect)((function(){if(m!==w.current&&(w.current=m,m)){var e=j.Ed.attach(t).connect(f);e.queryFilter(e.filters.LoanOffered(null,m),i).then(function(){var n=(0,r.Z)(c().mark((function n(a){var r,i,l,o,d,u;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.length){n.next=2;break}return n.abrupt("return");case 2:return a.sort((function(e,n){return n.args.applicationId.toNumber()-e.args.applicationId.toNumber()})),r=a[0].args.applicationId,n.next=6,e.loanApplications(r);case 6:if((i=n.sent).status===j.WR.OFFER_MADE){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,Promise.all([e.loanOffers(r),fetch("".concat(x.g9,"/profile/").concat(i.profileId)).then((function(e){return e.json()}))]);case 11:l=n.sent,o=(0,s.Z)(l,2),d=o[0],u=o[1],O({details:d,account:m,loanDeskAddress:t,contactDetails:u||{}});case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.error(e)}))}}),[m,i,t,f]);var _=(0,p.useState)(!1),A=_[0],k=_[1],P=(0,p.useState)(!1),B=P[0],M=P[1];return S&&S.account===m&&S.loanDeskAddress===t?(0,v.jsxs)(h.xu,{className:"loan-offer",overlay:B?(0,v.jsx)("h2",{className:"jsx-1350981446",children:"Funds withdrawn!"}):null,children:[(0,v.jsx)("h3",{className:"jsx-1350981446",children:"Offer Received"}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Amount"}),(0,v.jsxs)("div",{className:"jsx-1350981446",children:[(0,x.WU)((0,d.formatUnits)(S.details.amount,a))," ",x.ob]})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Installment amount"}),(0,v.jsxs)("div",{className:"jsx-1350981446",children:[(0,x.WU)((0,d.formatUnits)(S.details.installmentAmount,a))," ",x.ob]})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Installments"}),(0,v.jsx)("div",{className:"jsx-1350981446",children:S.details.installments})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Duration"}),(0,v.jsxs)("div",{className:"jsx-1350981446",children:[S.details.duration.toNumber()/x.L$," months"]})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Interest APR"}),(0,v.jsxs)("div",{className:"jsx-1350981446",children:[S.details.apr/10,"%"]})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Grace Default Period"}),(0,v.jsxs)("div",{className:"jsx-1350981446",children:[S.details.gracePeriod.toNumber()/x.u3," days"]})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Name"}),(0,v.jsx)("div",{className:"jsx-1350981446",children:S.contactDetails.name})]}),(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Business Name"}),(0,v.jsx)("div",{className:"jsx-1350981446",children:S.contactDetails.businessName})]}),S.contactDetails.phone?(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Phone"}),(0,v.jsx)("div",{className:"jsx-1350981446",children:(0,v.jsx)("a",{href:"tel:".concat(S.contactDetails.phone),className:"jsx-1350981446",children:S.contactDetails.phone})})]}):null,S.contactDetails.email?(0,v.jsxs)("div",{className:"jsx-1350981446 field",children:[(0,v.jsx)("div",{className:"jsx-1350981446 label",children:"Email"}),(0,v.jsx)("div",{className:"jsx-1350981446",children:(0,v.jsx)("a",{href:"mailto:".concat(S.contactDetails.email),className:"jsx-1350981446",children:S.contactDetails.email})})]}):null,(0,v.jsx)(h.zx,{disabled:B||A,loading:A,type:"submit",onClick:(0,r.Z)(c().mark((function e(){var n,t,a,s,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.prev=1,e.next=4,j.LJ.attach(o).connect(f.getSigner()).borrow(S.details.applicationId);case 4:return n=e.sent,e.next=7,(0,j.y5)(b,{tx:n,name:"Accept loan & withdraw"});case 7:t=e.sent,a=t.payload.receipt,s=N(a.events||[]),e.prev=10,s.s();case 12:if((r=s.n()).done){e.next=19;break}if((i=r.value).eventSignature!==j.X$){e.next=17;break}return e.next=17,b((0,j.vy)({poolAddress:o,loanId:u.O$.from(i.args.array[0])}));case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:M(!0),e.next=33;break;case 30:e.prev=30,e.t1=e.catch(1),console.error(e.t1);case 33:k(!1);case 34:case"end":return e.stop()}}),e,null,[[1,30],[10,21,24,27]])}))),children:"Accept Loan & Withdraw Funds"}),(0,v.jsx)(l(),{id:"1350981446",children:[".loan-offer>button{margin-top:16px;}",".loan-offer>h3{margin-top:0;}",".field.jsx-1350981446{margin-top:16px;}",".field.jsx-1350981446>.label.jsx-1350981446{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}"]})]}):null}function A(e){var n=e.pool,t=e.poolAddress,a=e.account,s=(0,x.yL)(),r=(0,j.q4)(t,a),i=(0,y.I0)();return(0,j.NQ)(t,a,i,n),r.sort((function(e,n){return e.id-n.id})).map((function(e){return(0,v.jsx)(k,{pool:n,poolAddress:t,loan:e,provider:s,dispatch:i,account:a},e.id)}))}function k(e){var n=e.pool,t=n.liquidityTokenAddress,a=n.liquidityTokenDecimals,s=n.loanDeskAddress,r=e.poolAddress,i=e.loan,o=e.provider,c=e.dispatch,f=e.account,y=(0,p.useState)(""),b=y[0],N=y[1],S=(0,x.NH)(i.amount,i.details.baseAmountRepaid,i.details.interestPaidUntil,i.apr),O=(0,p.useMemo)((function(){return u.O$.from(i.details.totalAmountRepaid)}),[i]),w=(0,j.tQ)(t,r,f),_=w.allowance,A=w.refetch,k=(0,p.useMemo)((function(){if(!_)return!1;var e=u.O$.from(_);return e.eq(x.bM)||e.lt(b?(0,d.parseUnits)(b,a):x.bM)}),[_,b,a]),P=(0,p.useState)(null),B=P[0],M=P[1],D=B&&B.applicationId===i.applicationId?B:null;(0,p.useEffect)((function(){j.Ed.connect(o).attach(s).loanApplications(i.applicationId).then((function(e){var n=e.profileId;return fetch("".concat(x.g9,"/profile/").concat(n))})).then((function(e){return e.json()})).then((function(e){return M(g(g({},e),{},{applicationId:i.applicationId}))}))}),[i,s,o]);var C=(0,p.useState)(!1),E=C[0],I=C[1],R=(0,p.useCallback)((function(e){e.preventDefault(),I(!0);var n=o.getSigner();k?(0,x.lN)(t).connect(n).approve(r,x.PM).then((function(e){return(0,j.y5)(c,{name:"Approve ".concat(x.ob),tx:e})})).then((function(){return A()})).then((function(){I(!1)})).catch((function(e){console.error(e),I(!1)})):j.LJ.connect(n).attach(r).repay(u.O$.from(i.id),(0,d.parseUnits)(b,a)).then((function(e){return(0,j.y5)(c,{tx:e,name:"Repay loan"})})).then((function(){return c((0,j.vy)({poolAddress:r,loanId:i.id}))})).then((function(){I(!1),N("")})).catch((function(e){console.error(e)}))}),[o,k,r,i,b,a,t,c,A]),L=i.status===j.kK.REPAID,q=(0,p.useMemo)((function(){if(L)return[];var e=u.O$.from(i.installmentAmount),n=m.ou.now(),t=i.duration/i.installments,a=u.O$.from(i.details.baseAmountRepaid),s=i.details.interestPaidUntil,r=x.bM;return Array.from({length:i.installments}).reduce((function(l,o,c){var d=c+1,u=i.borrowedTime+t*d,f=m.ou.fromSeconds(u),p=f,h=n>f,j=m.ou.fromSeconds(u+t),y=l[c-1],v=!1,b=e,g=(0,x.qJ)(i.amount,y?y.expectedBaseAmountRepaid:0,y?y.expectedTimestamp:i.borrowedTime,i.apr,u),N=g.principalOutstanding,S=g.interestOutstanding,O=(0,x.qJ)(i.amount,a,s,i.apr,u),w=O.principalOutstanding,_=O.interestOutstanding,A=O.daysPassed,k=w.add(_);e.gt(k)&&(b=k);var P=e.sub(S).add(y?y.expectedBaseAmountRepaid:x.bM);if(h){if(j)if(j>n)if(w.lte(N))v=!0;else{var B=(0,x.qJ)(i.amount,P,u,i.apr,u+t).principalOutstanding;p=n;var M=(0,x.qJ)(i.amount,i.details.baseAmountRepaid,i.details.interestPaidUntil,i.apr,Math.trunc(n.toSeconds())),D=M.interestOutstanding,C=M.daysPassed;b=w.sub(B).add(D),A=C,_=D}else v=!0}else{var E=l[c-1];if(E)if(E.amount.eq(x.bM)){if(w.lt(N)&&_.lt(S)){var I=(0,x.qJ)(i.amount,P,u,i.apr,u+t).principalOutstanding,R=(0,x.qJ)(i.amount,i.details.baseAmountRepaid,i.details.interestPaidUntil,i.apr,u),L=R.interestOutstanding,q=R.daysPassed;(b=w.sub(I).add(L)).lt(x.bM)?v=!0:(A=q,_=L)}}else if(E.amount.gt(e)&&n.equals(E.dateTime)){var U=(0,x.qJ)(i.amount,a,s,i.apr,u),T=U.interestOutstanding;_=T,A=U.daysPassed,b=P.sub(a).add(T)}}if(v)b=x.bM;else if(b.lt(_)){var $=b.mul(A).div(_);b=_.mul($).div(A),s+=$.toNumber()*x.u3}else a=a.add(b.sub(_)),s+=A*x.u3;return d===i.installments&&k.gt(b)&&(b=k),r=r.add(b),l[c]={date:p.toLocaleString(),dateTime:p,overdue:!!h&&!n.startOf("day").equals(f.startOf("day")),amount:b,skip:b.eq(x.bM),expectedBaseAmountRepaid:P,expectedTimestamp:u},l}),[])}),[i,L]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(h.xu,{children:[(0,v.jsx)("h2",{className:l().dynamic([["3881781575",[x.SB]]]),children:"Loan Status"}),(0,v.jsx)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" stats",children:(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" stat",children:[(0,v.jsx)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Outstanding"}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" value",children:[(0,x.WU)((0,d.formatUnits)(S,a))," ",x.ob]})]})})]}),(0,v.jsxs)("form",{onSubmit:R,className:l().dynamic([["3881781575",[x.SB]]])+" main",children:[(0,v.jsxs)(h.xu,{className:"repay",overlay:i.status===j.kK.REPAID?"Loan fully repaid":void 0,children:[(0,v.jsx)("h2",{className:l().dynamic([["3881781575",[x.SB]]]),children:"Repay Loan"}),(0,v.jsx)(h._Z,{decimals:a,value:b,onChange:N}),(0,v.jsx)(h.zx,{type:"submit",loading:E,disabled:0===Number(b)&&!k||E,children:k?"Approve ".concat(x.ob):"Repay"}),(0,v.jsx)(h.bZ,{style:"warning",title:"Late payments will affect your on chain credit rating"})]}),(0,v.jsxs)(h.xu,{className:"details",children:[(0,v.jsx)("h3",{className:l().dynamic([["3881781575",[x.SB]]]),children:"Loan Contract Details"}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Initial loan amount:"})," ",(0,x.WU)((0,d.formatUnits)(i.amount,a))," ",x.ob]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Repaid:"})," ",(0,x.WU)((0,d.formatUnits)(O,a))," ",x.ob]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Total interest paid:"})," ",(0,x.WU)((0,d.formatUnits)(i.details.interestPaid,a))," ",x.ob]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Duration:"})," ",i.duration/x.L$," months"]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Interest APR:"})," ",i.apr,"%"]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Grace default period:"})," ",i.gracePeriod/x.u3," days"]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Name:"})," ",null===D||void 0===D?void 0:D.name]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Business name:"})," ",null===D||void 0===D?void 0:D.businessName]}),null!==D&&void 0!==D&&D.phone?(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Phone:"})," ",(0,v.jsx)("a",{href:"tel:".concat(D.phone),className:l().dynamic([["3881781575",[x.SB]]]),children:D.phone})]}):null,null!==D&&void 0!==D&&D.email?(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" field",children:[(0,v.jsx)("span",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Email:"})," ",(0,v.jsx)("a",{href:"mailto:".concat(D.email),className:l().dynamic([["3881781575",[x.SB]]]),children:D.email})]}):null]})]}),L?null:(0,v.jsxs)(h.xu,{children:[(0,v.jsx)("h3",{className:l().dynamic([["3881781575",[x.SB]]]),children:"Future Re-Payments Due"}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" schedule",children:[(0,v.jsx)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Amount"}),(0,v.jsx)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" label",children:"Due"}),q.map((function(e,n){return e.skip?null:(0,v.jsxs)(p.Fragment,{children:[(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" "+((e.overdue?"red":"")||""),children:[(0,d.formatUnits)(e.amount,a)," ",x.ob]}),(0,v.jsxs)("div",{className:l().dynamic([["3881781575",[x.SB]]])+" "+((e.overdue?"red":"")||""),children:[e.date,e.overdue?" (overdue)":""]})]},n)}))]})]}),(0,v.jsx)(l(),{id:"3881781575",dynamic:[x.SB],children:["h2.__jsx-style-dynamic-selector,h3.__jsx-style-dynamic-selector{margin-top:0;margin-bottom:16px;}",".stats.__jsx-style-dynamic-selector>.stat.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}",".stats.__jsx-style-dynamic-selector>.stat.__jsx-style-dynamic-selector>.value.__jsx-style-dynamic-selector{font-weight:700;font-size:24px;}",".main.__jsx-style-dynamic-selector>.repay button{margin-top:8px;margin-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".details>.field.__jsx-style-dynamic-selector{margin-top:8px;}",".details>.field.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}",".schedule.__jsx-style-dynamic-selector{display:grid;grid-template-columns:minmax(auto,max-content) auto;row-gap:8px;-webkit-column-gap:16px;column-gap:16px;}",".schedule.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);}",".schedule.__jsx-style-dynamic-selector>.red.__jsx-style-dynamic-selector{color:".concat(x.SB,";}"),"@media screen and (min-width:1000px){.main.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.main.__jsx-style-dynamic-selector>.box{-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;margin:0;}.main.__jsx-style-dynamic-selector>.box:first-child{margin-right:8px;}.main.__jsx-style-dynamic-selector>.box:last-child{margin-left:8px;}}"]})]})}w.getInitialProps=function(e){return{address:(0,x.Kn)(e.query.address)}},n.default=w;var P=52*(7*x.u3)+x.u3;function B(e){var n=e.pool,t=n.managerAddress,a=n.loanDeskAddress,s=n.liquidityTokenDecimals,r=e.poolAddress,i=e.account,o=(0,x.yL)(),c=(0,y.I0)(),m=(0,p.useState)(false),f=m[0],b=m[1],g=(0,p.useCallback)((function(){return b(!0)}),[]),N=(0,p.useState)(!1),S=N[0],O=N[1];(0,p.useEffect)((function(){i&&O(!1)}),[i]);var w=(0,p.useState)(!1),_=w[0],A=w[1],k=(0,p.useState)(!1),B=k[0],C=k[1],E=(0,p.useState)(null),I=E[0],R=E[1],L=(0,p.useRef)();(0,p.useEffect)((function(){i!==L.current&&(L.current=i,i&&j.Ed.attach(a).connect(o).borrowerStats(i).then((function(e){var n=e.hasOpenApplication;R({hasOpenApplication:n,account:i,loanDeskAddress:a})})).catch((function(e){console.error(e)})))}),[i,a,o]);var q=I&&I.hasOpenApplication&&I.account===i&&a===I.loanDeskAddress,U=(0,j.E3)(r,a),T=(0,p.useState)(""),$=T[0],W=T[1],F=(0,p.useState)(""),J=F[0],Z=F[1],z=(0,p.useState)(""),H=z[0],K=z[1],X=(0,p.useState)(""),G=X[0],Q=X[1],V=(0,p.useRef)(null),Y=(0,p.useState)(""),ee=Y[0],ne=Y[1],te=(0,p.useState)(""),ae=te[0],se=te[1],re=x.L$,ie=(0,p.useMemo)((function(){if(!U)return{invalidAmountMessage:"",invalidDurationMessage:""};var e=Number(ae)*Number(re),n=e<U.minLoanDuration,t=e>U.maxLoanDuration;return{invalidAmountMessage:D(ee,s,U.minLoanAmount)?"":"Minimum amount is ".concat((0,x.WU)((0,d.formatUnits)(u.O$.from(U.minLoanAmount),s))),invalidDurationMessage:n?"Minimum duration is ".concat(U.minLoanDuration/x.u3," day"):t?"Maximum duration is ".concat(U.maxLoanDuration/P," years"):""}}),[U,ae,re,s,ee]),le=ie.invalidAmountMessage,oe=ie.invalidDurationMessage,ce=(0,p.useMemo)((function(){var e;return M($)?M(J)?M(G)||M(H)?null!==(e=V.current)&&void 0!==e&&e.checkValidity()?q?"x":le||oe||null:"Invalid email":"Please enter an email or phone number":"Please enter your business name":"Please enter your name"}),[J,G,le,oe,q,$,H]),de=t===i,ue=!U||Boolean(i&&!I),me=de||ue,fe=Boolean(_||me||!ee||ce||B),pe=(0,p.useCallback)((function(e){if(e.preventDefault(),i){if(!fe){A(!0);var n=(0,d.parseUnits)(ee,s),t=u.O$.from(Number(ae)*Number(re)),r=o.getSigner();r.signMessage("My name is ".concat($.trim(),".\nMy business name is ").concat(J.trim(),".").concat(H?"\nMy phone is ".concat(H.trim(),"."):"").concat(G?"\nMy email is ".concat(G.trim(),"."):"")).then((function(e){return fetch("".concat(x.g9,"/profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:$,businessName:J,phone:H,email:G,walletSignature:e,walletAddress:i.toLowerCase()})})})).then((function(e){return e.json()})).then((function(e){var s=e.id,i=e.digest;return j.Ed.attach(a).connect(r).requestLoan(n,t,s,i)})).then((function(e){return(0,j.y5)(c,{name:"Request loan for ".concat(ee," ").concat(x.ob),tx:e})})).then((function(){C(!0),A(!1)})).catch((function(e){console.error(e),A(!1)}))}}else O(!0)}),[i,J,fe,c,ae,re,G,s,a,$,H,o,ee]);return(0,v.jsxs)(h.xu,{loading:ue,overlay:de?"Manager can't request a loan":q?"A loan application you requested is pending approval":B?(0,v.jsxs)("div",{className:"jsx-3003883118",children:[(0,v.jsx)("h2",{className:"jsx-3003883118",children:"Thank you for applying!"}),(0,v.jsx)("h2",{className:"jsx-3003883118",children:"The pool manager will be in touch shortly."})]}):void 0,children:[(0,v.jsx)(l(),{id:"3003883118",children:["form.jsx-3003883118>h3.jsx-3003883118{margin:0;}","form.jsx-3003883118>label.jsx-3003883118{display:block;margin-top:16px;}","form.jsx-3003883118>label.jsx-3003883118>.label.jsx-3003883118{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}","form.jsx-3003883118>.alert-positioner.jsx-3003883118{margin-top:16px;}","form.jsx-3003883118>.alert-positioner.jsx-3003883118>.alert{width:100%;}","form.jsx-3003883118>.button-container.jsx-3003883118{margin-top:16px;position:relative;display:table;}","form.jsx-3003883118>.button-container.jsx-3003883118>.clickable.jsx-3003883118{position:absolute;top:0;left:0;width:100%;height:100%;cursor:not-allowed;}","@media screen and (min-width:800px){form.jsx-3003883118 .info.jsx-3003883118>.item.jsx-3003883118{-webkit-flex-basis:60%;-ms-flex-preferred-size:60%;flex-basis:60%;}form.jsx-3003883118 .info.jsx-3003883118>.item.jsx-3003883118:first-child{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;}}"]}),(0,v.jsxs)("form",{onSubmit:pe,className:"jsx-3003883118",children:[(0,v.jsx)("h3",{className:"jsx-3003883118",children:"Apply For a Loan"}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Account"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),disabled:!0,value:i?(0,x.Xn)(i):"",className:"jsx-3003883118"})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Name"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),placeholder:"John Smith",value:$,onChange:function(e){return W(e.target.value)},onBlur:function(){return!M($)&&b(!0)},className:"jsx-3003883118"})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Business Name"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),placeholder:"Green LLC",value:J,onChange:function(e){return Z(e.target.value)},onBlur:function(){return!M(J)&&b(!0)},className:"jsx-3003883118"})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Phone"}),(0,v.jsx)("input",{type:"tel",placeholder:"+1 (555) 343-3411",value:H,onChange:function(e){return K(e.target.value)},onBlur:function(){return!M(G)&&!M(H)&&b(!0)},className:"jsx-3003883118"})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Email"}),(0,v.jsx)("input",{ref:V,type:"email",placeholder:"johnsmith@gmail.com",value:G,onChange:function(e){return Q(e.target.value)},onBlur:function(){var e;return(!M(G)&&!M(H)||!(null!==(e=V.current)&&void 0!==e&&e.checkValidity()))&&b(!0)},className:"jsx-3003883118"})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Amount"}),(0,v.jsx)(h._Z,{decimals:s,value:ee,onChange:ne,disabled:me,onBlur:function(){return!D(ee,s,U.minLoanAmount)&&b(!0)},onKeyDown:function(e){return"Enter"===e.key?!D(ee,s,U.minLoanAmount)&&b(!0):void 0}})]}),(0,v.jsxs)("label",{className:"jsx-3003883118",children:[(0,v.jsx)("div",{className:"jsx-3003883118 label",children:"Duration"}),(0,v.jsx)(h._Z,{decimals:4,value:ae,onChange:se,onBlur:g,disabled:me,noToken:!0,label:"months",paddingRight:60,onKeyDown:function(e){return"Enter"===e.key?b(!0):void 0}})]}),f&&ce?(0,v.jsx)("div",{className:"jsx-3003883118 alert-positioner",children:(0,v.jsx)(h.bZ,{style:"error-filled",title:ce})}):null,(0,v.jsxs)("div",{className:"jsx-3003883118 button-container",children:[(0,v.jsx)(h.zx,{type:"submit",disabled:!!i&&fe,loading:_,children:i?"Request Loan":"Connect Wallet"}),i&&fe?(0,v.jsx)("div",{onClick:g,className:"jsx-3003883118 clickable"}):null]})]}),S?(0,v.jsx)(h.Ot,{onClose:function(){return O(!1)}}):null]})}function M(e){return Boolean(e.trim())}function D(e,n,t){return!!e&&(0,d.parseUnits)(e,n).gte(t)}},4713:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/borrow/[address]",function(){return t(2020)}])},9008:function(e,n,t){e.exports=t(6505)}},function(e){e.O(0,[774,888,179],(function(){return n=4713,e(e.s=n);var n}));var n=e.O();_N_E=n}]);