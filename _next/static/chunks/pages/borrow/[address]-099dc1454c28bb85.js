(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{7285:function(e,n,a){"use strict";var t;Object.defineProperty(n,"__esModule",{value:!0}),n.AmpStateContext=void 0;var l=((t=a(7294))&&t.__esModule?t:{default:t}).default.createContext({});n.AmpStateContext=l},9546:function(e,n,a){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isInAmpMode=i,n.useAmp=function(){return i(l.default.useContext(s.AmpStateContext))};var t,l=(t=a(7294))&&t.__esModule?t:{default:t},s=a(7285);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.ampFirst,a=void 0!==n&&n,t=e.hybrid,l=void 0!==t&&t,s=e.hasQuery,i=void 0!==s&&s;return a||l&&i}},6505:function(e,n,a){"use strict";var t=a(930);function l(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}Object.defineProperty(n,"__esModule",{value:!0}),n.defaultHead=u,n.default=void 0;var s,i=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};t.get||t.set?Object.defineProperty(n,a,t):n[a]=e[a]}return n.default=e,n}(a(7294)),r=(s=a(8252))&&s.__esModule?s:{default:s},o=a(7285),c=a(523),d=a(9546);a(7206);function u(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=[i.default.createElement("meta",{charSet:"utf-8"})];return e||n.push(i.default.createElement("meta",{name:"viewport",content:"width=device-width"})),n}function m(e,n){return"string"===typeof n||"number"===typeof n?e:n.type===i.default.Fragment?e.concat(i.default.Children.toArray(n.props.children).reduce((function(e,n){return"string"===typeof n||"number"===typeof n?e:e.concat(n)}),[])):e.concat(n)}var f=["name","httpEquiv","charSet","itemProp"];function p(e,n){return e.reduce((function(e,n){var a=i.default.Children.toArray(n.props.children);return e.concat(a)}),[]).reduce(m,[]).reverse().concat(u(n.inAmpMode)).filter(function(){var e=new Set,n=new Set,a=new Set,t={};return function(l){var s=!0,i=!1;if(l.key&&"number"!==typeof l.key&&l.key.indexOf("$")>0){i=!0;var r=l.key.slice(l.key.indexOf("$")+1);e.has(r)?s=!1:e.add(r)}switch(l.type){case"title":case"base":n.has(l.type)?s=!1:n.add(l.type);break;case"meta":for(var o=0,c=f.length;o<c;o++){var d=f[o];if(l.props.hasOwnProperty(d))if("charSet"===d)a.has(d)?s=!1:a.add(d);else{var u=l.props[d],m=t[d]||new Set;"name"===d&&i||!m.has(u)?(m.add(u),t[d]=m):s=!1}}}return s}}()).reverse().map((function(e,a){var s=e.key||a;if(!n.inAmpMode&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some((function(n){return e.props.href.startsWith(n)}))){var r=function(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?l(Object(a),!0).forEach((function(n){t(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}({},e.props||{});return r["data-href"]=r.href,r.href=void 0,r["data-optimized-fonts"]=!0,i.default.cloneElement(e,r)}return i.default.cloneElement(e,{key:s})}))}var x=function(e){var n=e.children,a=i.useContext(o.AmpStateContext),t=i.useContext(c.HeadManagerContext);return i.default.createElement(r.default,{reduceComponentsToState:p,headManager:t,inAmpMode:d.isInAmpMode(a)},n)};n.default=x},8252:function(e,n,a){"use strict";var t=a(7980),l=a(3227),s=a(8361),i=(a(2191),a(5971)),r=a(2715),o=a(1193);function c(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,t=o(e);if(n){var l=o(this).constructor;a=Reflect.construct(t,arguments,l)}else a=t.apply(this,arguments);return r(this,a)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var d=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};t.get||t.set?Object.defineProperty(n,a,t):n[a]=e[a]}return n.default=e,n}(a(7294));var u=function(e){i(a,e);var n=c(a);function a(e){var s;return l(this,a),(s=n.call(this,e)).emitChange=function(){s._hasHeadManager&&s.props.headManager.updateHead(s.props.reduceComponentsToState(t(s.props.headManager.mountedInstances),s.props))},s._hasHeadManager=s.props.headManager&&s.props.headManager.mountedInstances,s}return s(a,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),a}(d.Component);n.default=u},2020:function(e,n,a){"use strict";a.r(n);var t=a(9499),l=a(6835),s=a(29),i=a(5988),r=a.n(i),o=a(7794),c=a.n(o),d=a(1744),u=a(2593),m=a(9008),f=a(7294),p=a(9310),x=a(5462),h=a(2563),y=a(6594),v=a(5893);function j(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function b(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?j(Object(a),!0).forEach((function(n){(0,t.Z)(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function g(e,n){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(!e)return;if("string"===typeof e)return N(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return N(e,n)}(e))||n&&e&&"number"===typeof e.length){a&&(e=a);var t=0,l=function(){};return{s:l,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){r=!0,s=e},f:function(){try{i||null==a.return||a.return()}finally{if(r)throw s}}}}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var a=0,t=new Array(n);a<n;a++)t[a]=e[a];return t}var S="Borrow - ".concat(p.iC),L=function(e){var n,a=e.address,t=(0,p.mA)(),i=(0,p.yL)(),r=(0,y.I0)(),o=(0,y.v9)((function(e){return e.pools[a]})),d=null===(n=p.Q$.find((function(e){return e.address===a})))||void 0===n?void 0:n.name,u=(0,v.jsxs)(m.default,{children:[(0,v.jsx)("title",{children:S}),(0,v.jsx)("link",{rel:"icon",href:"".concat(p.O4,"/favicon.svg")})]}),j=function(e,n,a){var t=(0,f.useState)(),i=t[0],r=t[1],o=(0,f.useRef)();return(0,f.useEffect)((function(){if(e&&a&&n&&e!==o.current){o.current=e;for(var t=h.Ed.attach(a.loanDeskAddress),i=p.Kj===p.p5.mumbai?80:40,d=1;d<=i;d++)t.loanApplications(d).then(function(){var n=(0,s.Z)(c().mark((function n(s){var i,o,d,u;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s.borrower===e){n.next=2;break}return n.abrupt("return");case 2:if(s.status===h.WR.OFFER_MADE){n.next=5;break}return r(null),n.abrupt("return");case 5:return n.next=7,Promise.all([t.loanOffers(s.id),(0,p.rY)(s.id.toNumber()).then((function(e){return e||fetch("".concat(p.g9,"/profile/").concat(s.profileId)).then((function(e){return e.json()})).then((function(e){return(0,p.wQ)(s.id.toNumber(),e),e}))}))]);case 7:i=n.sent,o=(0,l.Z)(i,2),d=o[0],u=o[1],r({details:d,account:e,loanDeskAddress:a.loanDeskAddress,contactDetails:u||{}});case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.error(e)}))}}),[e,a,n]),i}(t,i,o),b=(0,h.q4)(a,t);(0,f.useMemo)((function(){return b.filter((function(e){return e.status===h.kK.OUTSTANDING}))}),[b]);return(0,h.NQ)(a,t,r,o),o?(0,v.jsxs)(x.T3,{children:[u,(0,v.jsx)(x.VB,{href:"/borrow"}),(0,v.jsx)("h1",{children:d}),(0,v.jsx)(_,{pool:o,poolAddress:a,account:t,loans:b}),(0,v.jsx)(M,{pool:o,poolAddress:a,account:t,offer:j}),j?null:(0,v.jsx)(w,{pool:o,poolAddress:a,account:t})]}):(0,v.jsx)(x.SX,{children:u})};function M(e){var n,a,t,l,i,o,d,m,j=e.pool,b=j.loanDeskAddress,N=j.liquidityTokenDecimals,S=(j.block,e.poolAddress),L=e.account,M=e.offer,_=(0,p.yL)(),A=(0,y.I0)(),w=(0,f.useState)(!1),D=w[0],O=w[1],C=(0,f.useState)(!1),k=C[0],B=C[1],P=(0,f.useState)(null!==(n=null===M||void 0===M||null===(a=M.contactDetails)||void 0===a?void 0:a.isLocalCurrencyLoan)&&void 0!==n&&n),G=P[0],I=(P[1],(0,f.useState)(null!==M&&void 0!==M&&null!==(t=M.contactDetails)&&void 0!==t&&t.isLocalCurrencyLoan?null===(l=M.contactDetails)||void 0===l?void 0:l.localDetail.fxRate:1)),E=I[0],R=(I[1],(0,f.useMemo)((function(){if(!M)return[!1,null];var e=M.details,n=e.amount,a=e.apr,t=e.duration,l=e.installments,s=e.installmentAmount,i=Math.trunc(Date.now()/1e3),r=t.toNumber();return[r%p.L$===0&&l===r/p.L$,{amount:n,apr:(0,p.bc)(a),installments:l,installmentAmount:s,duration:r,borrowedTime:i,details:{baseAmountRepaid:p.wL,totalAmountRepaid:p.wL,interestPaid:p.wL,interestPaidUntil:i}}]}),[M])),F=R[0],T=R[1],$=(0,h.uh)(T,u.O$.from((1e6*Number(null!==(i=null===M||void 0===M||null===(o=M.contactDetails)||void 0===o?void 0:o.localDetail.localInstallmentAmount)&&void 0!==i?i:0)).toFixed(0)),Number(E));return M&&M.account===L&&M.loanDeskAddress===b?(0,v.jsxs)(x.xu,{className:"loan-offer",overlay:k?(0,v.jsx)("h2",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:"Funds withdrawn!"}):null,children:[(0,v.jsx)("h3",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:"Offer Received"}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Amount"}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:[G?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(M.details.amount.mul((100*Number(E)).toFixed(0)).div(100),N,2,!0)," "," ","("]}):null,(0,p.nx)(M.details.amount,N)," ",p.ob,G?(0,v.jsx)(v.Fragment,{children:")"}):null]})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Installment amount"}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:[G?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(M.details.amount.mul((100*Number(E)).toFixed(0)).div(100),N,2,!0)," ",null===(d=M.contactDetails)||void 0===d?void 0:d.localDetail.localCurrencyCode," ","("]}):null,(0,p.nx)(M.details.installmentAmount,N,2,!0)," ",p.ob,G?(0,v.jsx)(v.Fragment,{children:")"}):null]})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Installments"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:M.details.installments})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Duration"}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:[M.details.duration.toNumber()/p.L$," months"]})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Interest APR"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:(0,p.T3)(M.details.apr/1e3)})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Grace Default Period"}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:[M.details.gracePeriod.toNumber()/p.u3," days"]})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Name"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:M.contactDetails.name})]}),(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Business Name"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:M.contactDetails.businessName})]}),M.contactDetails.phone?(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Phone"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:(0,v.jsx)("a",{href:"tel:".concat(M.contactDetails.phone),className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:M.contactDetails.phone})})]}):null,M.contactDetails.email?(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" field",children:[(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" label",children:"Email"}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:(0,v.jsx)("a",{href:"mailto:".concat(M.contactDetails.email),className:r().dynamic([["1430375520",[p.G9,p.LM]]]),children:M.contactDetails.email})})]}):null,(0,v.jsxs)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" schedule-container",children:[(0,v.jsx)(x.JJ,{amount:M.details.amount,monthly:F,schedule:$,liquidityTokenDecimals:N,isLocalCurrencyLoan:null!==(m=M.contactDetails.isLocalCurrencyLoan)&&void 0!==m&&m,localDetail:M.contactDetails.localDetail}),(0,v.jsx)("div",{className:r().dynamic([["1430375520",[p.G9,p.LM]]])+" schedule-notice",children:"If the details above are incorrect do not proceed. Contact the pool manager to update the offer."})]}),(0,v.jsx)(x.zx,{disabled:k||D,loading:D,type:"submit",onClick:(0,s.Z)(c().mark((function e(){var n,a,t,l,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.prev=1,e.next=4,h.Ed.attach(b).connect(_.getSigner()).borrow(M.details.applicationId);case 4:return n=e.sent,e.next=7,(0,h.y5)(A,{tx:n,name:"Accept loan & withdraw"});case 7:a=e.sent,t=a.payload.receipt,l=g(t.events||[]),e.prev=10,l.s();case 12:if((s=l.n()).done){e.next=19;break}if((i=s.value).eventSignature!==h.X$){e.next=17;break}return e.next=17,A((0,h.vy)({poolAddress:S,loanDeskAddress:b,loanId:u.O$.from(i.args.array[0])}));case 17:e.next=12;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:B(!0),e.next=33;break;case 30:e.prev=30,e.t1=e.catch(1),console.error(e.t1);case 33:O(!1);case 34:case"end":return e.stop()}}),e,null,[[1,30],[10,21,24,27]])}))),children:"Accept Loan & Withdraw Funds"}),(0,v.jsx)(r(),{id:"1430375520",dynamic:[p.G9,p.LM],children:[".loan-offer>button{margin-top:16px;}",".loan-offer>h3{margin-top:0;}",".field.__jsx-style-dynamic-selector{margin-top:16px;}",".field.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}",".schedule-container.__jsx-style-dynamic-selector{color:".concat(p.G9,";background-color:").concat(p.LM,";margin-top:16px;padding:12px 16px;border-radius:8px;font-weight:600;}"),".schedule-container.__jsx-style-dynamic-selector>.schedule-notice.__jsx-style-dynamic-selector{margin-top:16px;}"]})]}):null}function _(e){var n=e.pool,a=e.poolAddress,t=e.account,l=e.loans,s=(0,p.yL)(),i=(0,y.I0)();return l.sort((function(e,n){return n.id-e.id})).map((function(e){return(0,v.jsx)(A,{pool:n,poolAddress:a,loan:e,provider:s,dispatch:i,account:t},e.id)}))}function A(e){var n,a,t,l,s,i,o,c,m,y,j,g,N=e.pool,S=N.liquidityTokenAddress,L=N.liquidityTokenDecimals,M=N.loanDeskAddress,_=e.poolAddress,A=e.loan,w=e.provider,D=e.dispatch,O=e.account,C=(0,f.useState)(""),k=C[0],B=C[1],P=(0,p.NH)(A.amount,A.details.baseAmountRepaid,A.details.interestPaidUntil,A.apr),G=(0,f.useMemo)((function(){return u.O$.from(A.details.totalAmountRepaid)}),[A]),I=(0,h.tQ)(S,_,O),E=I.allowance,R=I.refetch,F=(0,f.useMemo)((function(){if(!E)return!1;var e=u.O$.from(E);return e.eq(p.bM)||e.lt(k?(0,d.vz)(k,L):p.bM)}),[E,k,L]),T=(0,f.useState)(null),$=T[0],q=T[1],Z=$&&$.applicationId===A.applicationId?$:null;(0,f.useEffect)((function(){h.Ed.attach(M).loanApplications(A.applicationId).then((function(e){var n=e.profileId;return(0,p.rY)(A.applicationId).then((function(e){return fetch("".concat(p.g9,"/profile/").concat(n)).then((function(e){return e.json()})).then((function(e){return(0,p.wQ)(A.applicationId,e),{info:e,profileId:n}}))}))})).then((function(e){var n=e.info,a=e.profileId;return q(b(b({},n),{},{profileId:a,applicationId:A.applicationId}))}))}),[A,M,w]);var z=(0,f.useState)(!1),K=z[0],H=z[1],U=(0,f.useCallback)((function(e){e.preventDefault(),H(!0);var n=w.getSigner(),a=(0,d.vz)(k,L);F?(0,p.lN)(S).connect(n).approve(_,a).then((function(e){return(0,h.y5)(D,{name:"Step 1 of 2 \u279c Approve ".concat(p.ob),tx:e})})).then((function(){return R()})).then((function(){H(!1)})).catch((function(e){console.error(e),H(!1)})):h.Ed.connect(n).attach(M).repay(u.O$.from(A.id),a).then((function(e){return(0,h.y5)(D,{tx:e,name:"Repay loan"})})).then((function(){return D((0,h.vy)({poolAddress:_,loanDeskAddress:M,loanId:A.id}))})).then((function(){H(!1),B("")})).catch((function(e){console.error(e)}))}),[w,F,_,A,k,L,S,D,R]),Q=A.status===h.kK.REPAID,X=(0,h.uh)(Q?null:A,u.O$.from((1e6*Number(null!==(n=null===$||void 0===$||null===(a=$.localDetail)||void 0===a?void 0:a.localInstallmentAmount)&&void 0!==n?n:0)).toFixed(0)),null!==(t=null===$||void 0===$||null===(l=$.localDetail)||void 0===l?void 0:l.fxRate)&&void 0!==t?t:1),J=Number(k)>0;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(x.xu,{children:[(0,v.jsx)("h2",{className:r().dynamic([["3881781575",[p.SB]]]),children:"Loan Status"}),(0,v.jsx)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" stats",children:(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" stat",children:[(0,v.jsx)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Outstanding"}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" value",children:[null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(P.mul((100*Number(null===(s=$.localDetail)||void 0===s?void 0:s.fxRate)).toFixed(0)).div(100),L,2,!0)," ",null===(i=$.localDetail)||void 0===i?void 0:i.localCurrencyCode," ","("]}):null,(0,p.nx)(P,L,2,!0)," ",p.ob,null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsx)(v.Fragment,{children:")"}):null]})]})})]}),(0,v.jsxs)("form",{onSubmit:U,className:r().dynamic([["3881781575",[p.SB]]])+" main",children:[(0,v.jsxs)(x.xu,{className:"repay",overlay:A.status===h.kK.REPAID?"Loan fully repaid":void 0,children:[(0,v.jsx)("h2",{className:r().dynamic([["3881781575",[p.SB]]]),children:"Repay Loan"}),(0,v.jsx)(x._Z,{decimals:L,value:k,onChange:B}),(0,v.jsx)(x.zx,{type:"submit",loading:K,disabled:!J||K,children:F&&J?"Step 1 of 2 \u279c Approve ".concat(p.ob):J&&!K?"Final Step \u279c Repay":"Repay"}),(0,v.jsx)(x.bZ,{style:"warning",title:"Late payments will affect your on chain credit rating"})]}),(0,v.jsxs)(x.xu,{className:"details",children:[(0,v.jsx)("h3",{className:r().dynamic([["3881781575",[p.SB]]]),children:"Loan Contract Details"}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Initial loan amount:"})," ",null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(u.O$.from((100*Number(null===(o=$.localDetail)||void 0===o?void 0:o.localLoanAmount)).toFixed(0)),2,2,!0)," ",null===(c=$.localDetail)||void 0===c?void 0:c.localCurrencyCode," ","("]}):null,(0,p.nx)(A.amount,L,2,!0)," ",p.ob,null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsx)(v.Fragment,{children:")"}):null]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Repaid:"})," ",null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(G.mul((100*Number(null===(m=$.localDetail)||void 0===m?void 0:m.fxRate)).toFixed(0)).div(100),L,2,!0)," ",null===(y=$.localDetail)||void 0===y?void 0:y.localCurrencyCode," ","("]}):null,(0,p.nx)(G,L,2,!0)," ",p.ob,null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsx)(v.Fragment,{children:")"}):null]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Total interest paid:"})," ",null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(u.O$.from(A.details.interestPaid).mul((100*Number(null===(j=$.localDetail)||void 0===j?void 0:j.fxRate)).toFixed(0)).div(100),L,2,!0)," ",null===(g=$.localDetail)||void 0===g?void 0:g.localCurrencyCode," ","("]}):null,(0,p.nx)(A.details.interestPaid,L,2,!0)," ",p.ob,null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsx)(v.Fragment,{children:")"}):null]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Duration:"})," ",A.duration/p.L$," months"]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Interest APR:"})," ",(0,p.T3)(A.apr/100)]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Grace default period:"})," ",A.gracePeriod/p.u3," days"]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Name:"})," ",null===Z||void 0===Z?void 0:Z.name]}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Business name:"})," ",null===Z||void 0===Z?void 0:Z.businessName]}),null!==Z&&void 0!==Z&&Z.phone?(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Phone:"})," ",(0,v.jsx)("a",{href:"tel:".concat(Z.phone),className:r().dynamic([["3881781575",[p.SB]]]),children:Z.phone})]}):null,null!==Z&&void 0!==Z&&Z.email?(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" field",children:[(0,v.jsx)("span",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Email:"})," ",(0,v.jsx)("a",{href:"mailto:".concat(Z.email),className:r().dynamic([["3881781575",[p.SB]]]),children:Z.email})]}):null]})]}),Q?null:(0,v.jsxs)(x.xu,{children:[(0,v.jsx)("h3",{className:r().dynamic([["3881781575",[p.SB]]]),children:"Re-Payment Schedule"}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" schedule",children:[(0,v.jsx)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Due"}),(0,v.jsx)("div",{className:r().dynamic([["3881781575",[p.SB]]])+" label",children:"Amount"}),X.map((function(e,n){var a;return e.skip?null:(0,v.jsxs)(f.Fragment,{children:[(0,v.jsx)("div",{className:r().dynamic([["3881781575",[p.SB]]]),children:e.date}),(0,v.jsxs)("div",{className:r().dynamic([["3881781575",[p.SB]]]),children:[null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsxs)(v.Fragment,{children:[(0,p.nx)(e.localAmount,L,2,!0)," ",null===(a=$.localDetail)||void 0===a?void 0:a.localCurrencyCode," ","("]}):null,(0,p.nx)(e.amount,L,2,!0)," ",p.ob,null!==$&&void 0!==$&&$.isLocalCurrencyLoan?(0,v.jsx)(v.Fragment,{children:")"}):null]})]},n)}))]})]}),(0,v.jsx)(r(),{id:"3881781575",dynamic:[p.SB],children:["h2.__jsx-style-dynamic-selector,h3.__jsx-style-dynamic-selector{margin-top:0;margin-bottom:16px;}",".stats.__jsx-style-dynamic-selector>.stat.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}",".stats.__jsx-style-dynamic-selector>.stat.__jsx-style-dynamic-selector>.value.__jsx-style-dynamic-selector{font-weight:700;font-size:24px;}",".main.__jsx-style-dynamic-selector>.repay button{margin-top:8px;margin-bottom:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}",".details>.field.__jsx-style-dynamic-selector{margin-top:8px;}",".details>.field.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}",".schedule.__jsx-style-dynamic-selector{display:grid;grid-template-columns:minmax(auto,max-content) auto;row-gap:8px;-webkit-column-gap:16px;column-gap:16px;}",".schedule.__jsx-style-dynamic-selector>.label.__jsx-style-dynamic-selector{color:var(--color-secondary);}",".schedule.__jsx-style-dynamic-selector>.red.__jsx-style-dynamic-selector{color:".concat(p.SB,";}"),"@media screen and (min-width:1000px){.main.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.main.__jsx-style-dynamic-selector>.box{-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;margin:0;}.main.__jsx-style-dynamic-selector>.box:first-child{margin-right:8px;}.main.__jsx-style-dynamic-selector>.box:last-child{margin-left:8px;}}"]})]})}L.getInitialProps=function(e){return{address:(0,p.Kn)(e.query.address)}},n.default=L;function w(e){var n=e.pool,a=n.managerAddress,t=n.loanDeskAddress,l=n.liquidityTokenDecimals,s=e.poolAddress,i=e.account,o=(0,p.yL)(),c=(0,y.I0)(),m=(0,f.useState)(!1),j=m[0],b=m[1];(0,f.useEffect)((function(){i&&b(!1)}),[i]);var g=(0,f.useState)(!1),N=g[0],S=g[1],L=(0,f.useState)(!1),M=L[0],_=L[1],A=(0,f.useState)(null),w=A[0],O=A[1],C=(0,f.useRef)();(0,f.useEffect)((function(){i!==C.current&&(C.current=i,i&&h.Ed.attach(t).hasOpenApplication(i).then((function(e){O({hasOpenApplication:e,account:i,loanDeskAddress:t})})).catch((function(e){console.error(e)})))}),[i,t,o]);var k=w&&w.hasOpenApplication&&w.account===i&&t===w.loanDeskAddress,B=(0,h.E3)(s,t),P=(0,f.useState)(""),G=P[0],I=P[1],E=(0,f.useState)(""),R=E[0],F=E[1],T=(0,f.useState)(""),$=T[0],q=T[1],Z=(0,f.useState)(""),z=Z[0],K=Z[1],H=(0,f.useState)(""),U=H[0],Q=H[1],X=(0,f.useState)(""),J=X[0],W=X[1],V=(0,f.useState)(""),Y=V[0],ee=V[1],ne=p.L$,ae=(0,f.useMemo)((function(){if(!B)return{invalidAmountMessage:"",invalidAmountLocalMessage:"",invalidDurationMessage:""};var e=Number(Y)*Number(ne),n=e<B.minLoanDuration,a=e>B.maxLoanDuration,t=(0,p.BJ)(U,l,B.minLoanAmount),s=(0,p.BJ)(J,l,u.O$.from(B.minLoanAmount).mul(p.gM));return{invalidAmountMessage:t?"":"Minimum amount is ".concat((0,p.nx)(u.O$.from(B.minLoanAmount),l)),invalidAmountLocalMessage:s?"":"Minimum amount is ".concat((0,p.nx)(u.O$.from(B.minLoanAmount).mul(p.gM),l)),invalidDurationMessage:n?"Minimum duration is ".concat(B.minLoanDuration/p.u3," day"):a?"Maximum duration is ".concat(B.maxLoanDuration/p.eV," years"):""}}),[B,Y,ne,l,U]),te=ae.invalidAmountLocalMessage,le=ae.invalidAmountMessage,se=ae.invalidDurationMessage,ie=(0,f.useState)(!1),re=ie[0],oe=ie[1],ce=!D(G),de=(0,f.useState)(!1),ue=de[0],me=de[1],fe=!D(R),pe=(0,f.useState)(!1),xe=pe[0],he=pe[1],ye=(0,f.useState)(!1),ve=ye[0],je=ye[1],be=!D(z)&&!D($),ge=(0,f.useState)(!1),Ne=ge[0],Se=ge[1],Le=(0,f.useState)(!1),Me=Le[0],_e=Le[1],Ae=(0,f.useState)(!1),we=Ae[0],De=Ae[1],Oe=(0,f.useState)(!1),Ce=Oe[0],ke=Oe[1],Be=a===i,Pe=!B||Boolean(i&&!w),Ge=Be||Pe,Ie=Boolean(N||Ge||!J||!U||ce||fe||be||Ne||le||te||se||k||M),Ee=(0,f.useState)(null),Re=Ee[0],Fe=Ee[1],Te=(0,f.useState)(!1),$e=Te[0],qe=Te[1],Ze=(0,f.useCallback)((function(e){if(e.preventDefault(),i){if(!Ie){S(!0);var n=(0,d.vz)(U,l),a=u.O$.from(Number(Y)*Number(ne));o.getSigner().signMessage("My name is ".concat(G.trim(),".\nMy business name is ").concat(R.trim(),".").concat($?"\nMy phone is ".concat($.trim(),"."):"").concat(z?"\nMy email is ".concat(z.trim(),"."):"")).then((function(e){return fetch("".concat(p.g9,"/profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:G,businessName:R,phone:$,email:z,walletSignature:e,walletAddress:i.toLowerCase(),poolAddress:s,isLocalCurrencyLoan:!0,localDetail:{localLoanAmount:J,localCurrencyCode:p.KN,fxRate:p.gM}})})})).then((function(e){return e.json()})).then((function(e){var t=e.id,l=e.digest;return Fe({parsedAmount:n,parsedDuration:a,id:t,digest:l,name:G,businessName:R,phone:$,email:z})})).catch((function(e){console.error(e),S(!1)}))}}else b(!0)}),[i,Ie,U,J,l,Y,ne,o,G,R,$,z,s]);return(0,v.jsxs)(x.xu,{loading:Pe,overlay:i?Be?"Manager can't request a loan":k?"A loan application you requested is pending approval":M?(0,v.jsxs)("div",{className:"jsx-1483254474",children:[(0,v.jsx)("h2",{className:"jsx-1483254474",children:"Thank you for applying!"}),(0,v.jsx)("h2",{className:"jsx-1483254474",children:"The pool manager will be in touch shortly."})]}):void 0:(0,v.jsx)(x.zx,{type:"button",onClick:function(){return b(!0)},children:"Connect Wallet"}),children:[(0,v.jsx)(r(),{id:"1483254474",children:["form.jsx-1483254474>h3.jsx-1483254474{z-index:5;position:relative;margin:0;}","form.jsx-1483254474>label.jsx-1483254474{display:block;margin-top:16px;}","form.jsx-1483254474>label.jsx-1483254474>.label.jsx-1483254474{color:var(--color-secondary);font-weight:400;margin-bottom:8px;}","form.jsx-1483254474>label.jsx-1483254474>input.jsx-1483254474{display:block;}","form.jsx-1483254474>label.jsx-1483254474>.alert{margin-top:8px;}","form.jsx-1483254474>.alert-positioner.jsx-1483254474{margin-top:16px;}","form.jsx-1483254474>.alert-positioner.jsx-1483254474>.alert{width:100%;}","form.jsx-1483254474>.button-container.jsx-1483254474{margin-top:16px;position:relative;display:table;}","form.jsx-1483254474>.button-container.jsx-1483254474>.clickable.jsx-1483254474{position:absolute;top:0;left:0;width:100%;height:100%;cursor:not-allowed;}","@media screen and (min-width:800px){form.jsx-1483254474 .info.jsx-1483254474>.item.jsx-1483254474{-webkit-flex-basis:60%;-ms-flex-preferred-size:60%;flex-basis:60%;}form.jsx-1483254474 .info.jsx-1483254474>.item.jsx-1483254474:first-child{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;}}"]}),(0,v.jsxs)("form",{onSubmit:Ze,className:"jsx-1483254474",children:[(0,v.jsx)("h3",{className:"jsx-1483254474",children:"Apply For a Loan"}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Account"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),disabled:!0,value:i?(0,p.Xn)(i):"",className:"jsx-1483254474"})]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Name"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),placeholder:"John Smith",value:G,onChange:function(e){return I(e.target.value)},onBlur:function(){return oe(!0)},className:"jsx-1483254474 "+((re&&ce?"invalid":"")||"")}),re&&ce?(0,v.jsx)(x.bZ,{style:"error",title:"Please enter your name"}):null]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Business Name"}),(0,v.jsx)("input",{type:"text",required:Boolean(i),placeholder:"Green LLC",value:R,onChange:function(e){return F(e.target.value)},onBlur:function(){return me(!0)},className:"jsx-1483254474 "+((ue&&fe?"invalid":"")||"")}),ue&&fe?(0,v.jsx)(x.bZ,{style:"error",title:"Please enter your business name"}):null]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Phone"}),(0,v.jsx)("input",{type:"tel",placeholder:"+1 (555) 343-3411",value:$,onChange:function(e){return q(e.target.value)},onBlur:function(){return he(!0)},className:"jsx-1483254474 "+((xe&&ve&&be?"invalid":"")||"")})]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Email"}),(0,v.jsx)("input",{type:"email",placeholder:"johnsmith@gmail.com",value:z,onChange:function(e){var n=e.target.value;K(n),Se(Boolean(n&&!e.target.checkValidity()))},onBlur:function(){return je(!0)},className:"jsx-1483254474 "+((xe&&ve&&(be||Ne)?"invalid":"")||"")}),xe&&ve?be?(0,v.jsx)(x.bZ,{style:"error",title:"Please enter an email or phone number"}):Ne?(0,v.jsx)(x.bZ,{style:"error",title:"Invalid email"}):null:null]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Amount in Local Currency"}),(0,v.jsx)(x._Z,{invalid:Me&&Boolean(te),decimals:2,value:J,onChange:function(e){W(e);var n=e&&e.trim().length>=1?Number(e):0;Q((n/p.gM).toFixed(2))},disabled:Ge,onBlur:function(){return _e(!0)},onKeyDown:function(e){return"Enter"===e.key?_e(!0):void 0},currency:p.KN}),Me&&te?(0,v.jsx)(x.bZ,{style:"error",title:te}):null]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Amount"}),(0,v.jsx)(x._Z,{invalid:we&&Boolean(le),decimals:2,value:U,onChange:function(e){Q(e);var n=e&&e.trim().length>=1?Number(e):0;W((n*p.gM).toFixed(2))},disabled:Ge,onBlur:function(){return De(!0)},onKeyDown:function(e){return"Enter"===e.key?De(!0):void 0}}),we&&le?(0,v.jsx)(x.bZ,{style:"error",title:le}):null]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"FX Rate, 1 USDT = "}),(0,v.jsx)("input",{type:"text",disabled:!0,value:p.gM+" UGX",className:"jsx-1483254474"})]}),(0,v.jsxs)("label",{className:"jsx-1483254474",children:[(0,v.jsx)("div",{className:"jsx-1483254474 label",children:"Duration"}),(0,v.jsx)(x._Z,{decimals:4,value:Y,onChange:ee,invalid:Ce&&Boolean(se),onBlur:function(){return ke(!0)},disabled:Ge,noToken:!0,label:"months",paddingRight:60,onKeyDown:function(e){return"Enter"===e.key?ke(!0):void 0}}),Ce&&se?(0,v.jsx)(x.bZ,{style:"error",title:se}):null]}),(0,v.jsxs)("div",{className:"jsx-1483254474 button-container",children:[(0,v.jsx)(x.zx,{type:"submit",disabled:Ie,loading:N,children:"Request Loan"}),i&&Ie?(0,v.jsx)("div",{onClick:function(){oe(!0),me(!0),he(!0),je(!0),_e(!0),De(!0),ke(!0)},className:"jsx-1483254474 clickable"}):null]})]}),j?(0,v.jsx)(x.Ot,{onClose:function(){return b(!1)}}):null,!!Re&&(0,v.jsxs)(x.u_,{onClose:function(){qe(!1),S(!1),Fe(null)},children:[(0,v.jsx)("p",{style:{textAlign:"center"},className:"jsx-1483254474",children:"Signature accepted. Press submit request to continue."}),(0,v.jsx)(x.zx,{type:"button",loading:$e,disabled:$e,style:{display:"flex",margin:"0 auto 20px"},onClick:function(){qe(!0),h.Ed.attach(t).connect(o.getSigner()).requestLoan(Re.parsedAmount,Re.parsedDuration,Re.id,Re.digest).then((function(e){return(0,h.y5)(c,{name:"Request loan for ".concat(U," ").concat(p.ob),tx:e})})).then((function(e){var n;_(!0),S(!1),Fe(null),qe(!1);var a=null===(n=e.payload.receipt.events)||void 0===n?void 0:n[0];"LoanRequested(uint256,address)"===(null===a||void 0===a?void 0:a.eventSignature)&&(0,p.wQ)(u.O$.from(a.args.array[0]).toNumber(),{name:Re.name,businessName:Re.businessName,phone:Re.phone,email:Re.email,isLocalCurrencyLoan:!0,localDetail:{localLoanAmount:J,localCurrencyCode:p.KN,fxRate:p.gM,localInstallmentAmount:"0"}})})).catch((function(e){console.error(e),qe(!1)}))},children:"Submit Request"})]})]})}function D(e){return Boolean(e.trim())}},4713:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/borrow/[address]",function(){return a(2020)}])},9008:function(e,n,a){e.exports=a(6505)}},function(e){e.O(0,[774,888,179],(function(){return n=4713,e(e.s=n);var n}));var n=e.O();_N_E=n}]);